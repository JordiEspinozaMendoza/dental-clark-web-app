{"ast":null,"code":"import _slicedToArray from\"C:/Users/dell/Documents/Proyects/Dental Clark/backend/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import\"./consults.css\";import{Row,Col,Image,Button,Form,Modal,InputGroup,FormControl,ListGroup}from\"react-bootstrap\";import FormContainer from\"../../../Form\";import{searchPatients,getPatientDetails}from\"../../../../actions/patientActions\";import{update,consultDetails}from\"../../../../actions/consultActions\";import Loader from\"../../../Loader\";import Message from\"../../../Message\";import{CONSULT_UPDATE_RESET}from\"../../../../constants/consultConstants\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function UpdateConsult(props,_ref){var history=_ref.history;//Detalles de consulta\nvar _useState=useState(0),_useState2=_slicedToArray(_useState,2),patient=_useState2[0],setPatient=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),details=_useState4[0],setDetails=_useState4[1];var _useState5=useState(0.0),_useState6=_slicedToArray(_useState5,2),price=_useState6[0],setPrice=_useState6[1];var consultId=props.Id;var _useState7=useState(0.0),_useState8=_slicedToArray(_useState7,2),payment=_useState8[0],setPayment=_useState8[1];//Fin detalles de consulta\nvar _useState9=useState(\"Selecciona un paciente\"),_useState10=_slicedToArray(_useState9,2),patientSelected=_useState10[0],setPatientSelected=_useState10[1];var dispatch=useDispatch();var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),lgShow=_useState12[0],setLgShow=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),patientsToSearch=_useState14[0],setPatientsToSearch=_useState14[1];var patientSearch=useSelector(function(state){return state.patientSearch;});var loading=patientSearch.loading,error=patientSearch.error,patients=patientSearch.patients;var userLogin=useSelector(function(state){return state.userLogin;});var userInfo=userLogin.userInfo;var consultDetailsReducer=useSelector(function(state){return state.consultDetails;});var loadingDetails=consultDetailsReducer.loading,errorDetails=consultDetailsReducer.error,consult=consultDetailsReducer.consult;var consultUpdate=useSelector(function(state){return state.consultUpdate;});var loadingUpdate=consultUpdate.loading,errorUpdate=consultUpdate.error,successUpdate=consultUpdate.success;var submitHandler=function submitHandler(e){e.preventDefault();dispatch(update({_id:consultId,user:userInfo._id,patient:Number(patient),price:price,details:details,payment:payment}));};useEffect(function(){if(successUpdate){dispatch({type:CONSULT_UPDATE_RESET});dispatch(consultDetails(consultId));props.onChange(\"consults\");}else{if(!consult||consult._id!==Number(consultId))dispatch(consultDetails(consultId));else{setDetails(consult.details);setPrice(consult.price);setPayment(consult.payment);setPatient(consult.patient._id);setPatientSelected(consult.patient.name+\" \"+consult.patient.lastName);}if(userInfo){dispatch(searchPatients(patientsToSearch));}else{history.push(\"/\");}}},[consult,consultId,userInfo,patientsToSearch,successUpdate,props]);return/*#__PURE__*/_jsxs(_Fragment,{children:[loadingDetails?/*#__PURE__*/_jsx(Loader,{}):errorDetails?/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:errorDetails}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Editar consulta\"}),/*#__PURE__*/_jsxs(Form,{onSubmit:submitHandler,children:[/*#__PURE__*/_jsxs(InputGroup,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(FormControl,{placeholder:patientSelected,\"aria-label\":\"Paciente\",\"aria-describedby\":\"pacientSelected\",readOnly:true,style:{backgroundColor:\"white\",hover:{cursor:\"none\"},cursor:\"default\"}}),/*#__PURE__*/_jsx(InputGroup.Append,{children:/*#__PURE__*/_jsx(InputGroup.Text,{id:\"pacientSelected\",style:{marginTop:\"0\",cursor:\"pointer\"},onClick:function onClick(){return setLgShow(true);},children:\"Selecciona un paciente\"})})]}),/*#__PURE__*/_jsxs(Form.Group,{children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Detalles\"}),/*#__PURE__*/_jsx(Form.Control,{as:\"textarea\",placeholder:\"Detalles de la consulta\",rows:3,value:details,onChange:function onChange(e){return setDetails(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Group,{children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Precio total\"}),/*#__PURE__*/_jsxs(InputGroup,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(InputGroup.Prepend,{children:/*#__PURE__*/_jsx(InputGroup.Text,{style:{marginTop:\"0\"},children:\"$\"})}),/*#__PURE__*/_jsx(FormControl,{type:\"number\",value:price,onChange:function onChange(e){return setPrice(e.target.value);}}),/*#__PURE__*/_jsx(InputGroup.Append,{children:/*#__PURE__*/_jsx(InputGroup.Text,{style:{marginTop:\"0\"},children:\".00\"})})]})]}),/*#__PURE__*/_jsxs(Form.Group,{children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Abon\\xF3\"}),/*#__PURE__*/_jsxs(InputGroup,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(InputGroup.Prepend,{children:/*#__PURE__*/_jsx(InputGroup.Text,{style:{marginTop:\"0\"},children:\"$\"})}),/*#__PURE__*/_jsx(FormControl,{type:\"number\",value:payment,onChange:function onChange(e){return setPayment(e.target.value);}}),/*#__PURE__*/_jsx(InputGroup.Append,{children:/*#__PURE__*/_jsx(InputGroup.Text,{style:{marginTop:\"0\"},children:\".00\"})})]})]}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"primary\",children:\"Registrar consulta\"})]})]}),/*#__PURE__*/_jsxs(Modal,{size:\"lg\",show:lgShow,onHide:function onHide(){return setLgShow(false);},\"aria-labelledby\":\"example-modal-sizes-title-lg\",children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{id:\"example-modal-sizes-title-lg\",children:\"Selecciona un paciente\"})}),/*#__PURE__*/_jsxs(Modal.Body,{style:{minHeight:\"85vh\"},children:[/*#__PURE__*/_jsx(Form,{onSubmit:function onSubmit(e){return e.preventDefault();},children:/*#__PURE__*/_jsx(Form.Group,{children:/*#__PURE__*/_jsxs(InputGroup,{children:[/*#__PURE__*/_jsx(InputGroup.Prepend,{children:/*#__PURE__*/_jsx(InputGroup.Text,{style:{marginTop:\"0\"},children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-search\"})})}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"Buscar\",value:patientsToSearch,onChange:function onChange(e){return setPatientsToSearch(e.target.value);}})]})})}),/*#__PURE__*/_jsx(ListGroup,{variant:\"flush\",children:loading?/*#__PURE__*/_jsx(Loader,{}):error?/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:error}):patients.length==0?/*#__PURE__*/_jsxs(Message,{variant:\"warning\",children:[\"No hay resultados para \",patientsToSearch]}):patients===null||patients===void 0?void 0:patients.map(function(patient){return/*#__PURE__*/_jsxs(ListGroup.Item,{className:\"patientsItems\",style:{cursor:\"pointer\"},onClick:function onClick(){setPatient(patient._id);setLgShow(false);setPatientSelected(patient.name+\" \"+patient.lastName);},children:[\"ID: \",patient._id,/*#__PURE__*/_jsx(\"br\",{}),patient.name+\" \"+patient.lastName,/*#__PURE__*/_jsx(\"br\",{}),patient.email]});})})]})]})]});}","map":{"version":3,"sources":["C:/Users/dell/Documents/Proyects/Dental Clark/backend/frontend/src/components/Dashboard/components/consults/updateConsult.js"],"names":["React","useState","useEffect","useDispatch","useSelector","Row","Col","Image","Button","Form","Modal","InputGroup","FormControl","ListGroup","FormContainer","searchPatients","getPatientDetails","update","consultDetails","Loader","Message","CONSULT_UPDATE_RESET","UpdateConsult","props","history","patient","setPatient","details","setDetails","price","setPrice","consultId","Id","payment","setPayment","patientSelected","setPatientSelected","dispatch","lgShow","setLgShow","patientsToSearch","setPatientsToSearch","patientSearch","state","loading","error","patients","userLogin","userInfo","consultDetailsReducer","loadingDetails","errorDetails","consult","consultUpdate","loadingUpdate","errorUpdate","successUpdate","success","submitHandler","e","preventDefault","_id","user","Number","type","onChange","name","lastName","push","backgroundColor","hover","cursor","marginTop","target","value","minHeight","length","map","email"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\n\r\nimport \"./consults.css\";\r\n\r\nimport {\r\n  Row,\r\n  Col,\r\n  Image,\r\n  Button,\r\n  Form,\r\n  Modal,\r\n  InputGroup,\r\n  FormControl,\r\n  ListGroup,\r\n} from \"react-bootstrap\";\r\nimport FormContainer from \"../../../Form\";\r\nimport {\r\n  searchPatients,\r\n  getPatientDetails,\r\n} from \"../../../../actions/patientActions\";\r\nimport { update, consultDetails } from \"../../../../actions/consultActions\";\r\nimport Loader from \"../../../Loader\";\r\nimport Message from \"../../../Message\";\r\nimport { CONSULT_UPDATE_RESET } from \"../../../../constants/consultConstants\";\r\n\r\nexport default function UpdateConsult(props, { history }) {\r\n  //Detalles de consulta\r\n  const [patient, setPatient] = useState(0);\r\n  const [details, setDetails] = useState(\"\");\r\n  const [price, setPrice] = useState(0.0);\r\n  const consultId = props.Id;\r\n  const [payment, setPayment] = useState(0.0);\r\n\r\n  //Fin detalles de consulta\r\n  const [patientSelected, setPatientSelected] = useState(\r\n    \"Selecciona un paciente\"\r\n  );\r\n  const dispatch = useDispatch();\r\n\r\n  const [lgShow, setLgShow] = useState(false);\r\n  const [patientsToSearch, setPatientsToSearch] = useState(\"\");\r\n  const patientSearch = useSelector((state) => state.patientSearch);\r\n  const { loading, error, patients } = patientSearch;\r\n\r\n  const userLogin = useSelector((state) => state.userLogin);\r\n  const { userInfo } = userLogin;\r\n\r\n  const consultDetailsReducer = useSelector((state) => state.consultDetails);\r\n  const {\r\n    loading: loadingDetails,\r\n    error: errorDetails,\r\n    consult,\r\n  } = consultDetailsReducer;\r\n\r\n  const consultUpdate = useSelector((state) => state.consultUpdate);\r\n  const {\r\n    loading: loadingUpdate,\r\n    error: errorUpdate,\r\n    success: successUpdate,\r\n  } = consultUpdate;\r\n\r\n  const submitHandler = (e) => {\r\n    e.preventDefault();\r\n    dispatch(\r\n      update({\r\n        _id: consultId,\r\n        user: userInfo._id,\r\n        patient: Number(patient),\r\n        price: price,\r\n        details: details,\r\n        payment: payment,\r\n      })\r\n    );\r\n  };\r\n  useEffect(() => {\r\n    if (successUpdate) {\r\n      dispatch({ type: CONSULT_UPDATE_RESET });\r\n      dispatch(consultDetails(consultId));\r\n      props.onChange(\"consults\");\r\n    } else {\r\n      if (!consult || consult._id !== Number(consultId))\r\n        dispatch(consultDetails(consultId));\r\n      else {\r\n        setDetails(consult.details);\r\n        setPrice(consult.price);\r\n        setPayment(consult.payment);\r\n        setPatient(consult.patient._id);\r\n        setPatientSelected(\r\n          consult.patient.name + \" \" + consult.patient.lastName\r\n        );\r\n      }\r\n\r\n      if (userInfo) {\r\n        dispatch(searchPatients(patientsToSearch));\r\n      } else {\r\n        history.push(\"/\");\r\n      }\r\n    }\r\n  }, [consult, consultId, userInfo, patientsToSearch, successUpdate, props]);\r\n\r\n  return (\r\n    <>\r\n      {loadingDetails ? (\r\n        <Loader />\r\n      ) : errorDetails ? (\r\n        <Message variant=\"danger\">{errorDetails}</Message>\r\n      ) : (\r\n        <>\r\n          <h1>Editar consulta</h1>\r\n          <Form onSubmit={submitHandler}>\r\n            <InputGroup className=\"mb-3\">\r\n              <FormControl\r\n                placeholder={patientSelected}\r\n                aria-label=\"Paciente\"\r\n                aria-describedby=\"pacientSelected\"\r\n                readOnly={true}\r\n                style={{\r\n                  backgroundColor: \"white\",\r\n                  hover: { cursor: \"none\" },\r\n                  cursor: \"default\",\r\n                }}\r\n              />\r\n              <InputGroup.Append>\r\n                <InputGroup.Text\r\n                  id=\"pacientSelected\"\r\n                  style={{ marginTop: \"0\", cursor: \"pointer\" }}\r\n                  onClick={() => setLgShow(true)}\r\n                >\r\n                  Selecciona un paciente\r\n                </InputGroup.Text>\r\n              </InputGroup.Append>\r\n            </InputGroup>\r\n\r\n            <Form.Group>\r\n              <Form.Label>Detalles</Form.Label>\r\n              <Form.Control\r\n                as=\"textarea\"\r\n                placeholder=\"Detalles de la consulta\"\r\n                rows={3}\r\n                value={details}\r\n                onChange={(e) => setDetails(e.target.value)}\r\n              ></Form.Control>\r\n            </Form.Group>\r\n\r\n            <Form.Group>\r\n              <Form.Label>Precio total</Form.Label>\r\n\r\n              <InputGroup className=\"mb-3\">\r\n                <InputGroup.Prepend>\r\n                  <InputGroup.Text style={{ marginTop: \"0\" }}>\r\n                    $\r\n                  </InputGroup.Text>\r\n                </InputGroup.Prepend>\r\n                <FormControl\r\n                  type=\"number\"\r\n                  value={price}\r\n                  onChange={(e) => setPrice(e.target.value)}\r\n                />\r\n                <InputGroup.Append>\r\n                  <InputGroup.Text style={{ marginTop: \"0\" }}>\r\n                    .00\r\n                  </InputGroup.Text>\r\n                </InputGroup.Append>\r\n              </InputGroup>\r\n            </Form.Group>\r\n            <Form.Group>\r\n              <Form.Label>Abon√≥</Form.Label>\r\n\r\n              <InputGroup className=\"mb-3\">\r\n                <InputGroup.Prepend>\r\n                  <InputGroup.Text style={{ marginTop: \"0\" }}>\r\n                    $\r\n                  </InputGroup.Text>\r\n                </InputGroup.Prepend>\r\n                <FormControl\r\n                  type=\"number\"\r\n                  value={payment}\r\n                  onChange={(e) => setPayment(e.target.value)}\r\n                />\r\n                <InputGroup.Append>\r\n                  <InputGroup.Text style={{ marginTop: \"0\" }}>\r\n                    .00\r\n                  </InputGroup.Text>\r\n                </InputGroup.Append>\r\n              </InputGroup>\r\n            </Form.Group>\r\n\r\n            <Button type=\"submit\" variant=\"primary\">\r\n              Registrar consulta\r\n            </Button>\r\n          </Form>\r\n        </>\r\n      )}\r\n      <Modal\r\n        size=\"lg\"\r\n        show={lgShow}\r\n        onHide={() => setLgShow(false)}\r\n        aria-labelledby=\"example-modal-sizes-title-lg\"\r\n      >\r\n        <Modal.Header closeButton>\r\n          <Modal.Title id=\"example-modal-sizes-title-lg\">\r\n            Selecciona un paciente\r\n          </Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body style={{ minHeight: \"85vh\" }}>\r\n          <Form onSubmit={(e) => e.preventDefault()}>\r\n            <Form.Group>\r\n              <InputGroup>\r\n                <InputGroup.Prepend>\r\n                  <InputGroup.Text style={{ marginTop: \"0\" }}>\r\n                    <i className=\"fas fa-search\"></i>\r\n                  </InputGroup.Text>\r\n                </InputGroup.Prepend>\r\n                <Form.Control\r\n                  type=\"text\"\r\n                  placeholder=\"Buscar\"\r\n                  value={patientsToSearch}\r\n                  onChange={(e) => setPatientsToSearch(e.target.value)}\r\n                ></Form.Control>\r\n              </InputGroup>\r\n            </Form.Group>\r\n          </Form>\r\n          <ListGroup variant=\"flush\">\r\n            {loading ? (\r\n              <Loader />\r\n            ) : error ? (\r\n              <Message variant=\"danger\">{error}</Message>\r\n            ) : patients.length == 0 ? (\r\n              <Message variant=\"warning\">\r\n                No hay resultados para {patientsToSearch}\r\n              </Message>\r\n            ) : (\r\n              patients?.map((patient) => (\r\n                <ListGroup.Item\r\n                  className=\"patientsItems\"\r\n                  style={{\r\n                    cursor: \"pointer\",\r\n                  }}\r\n                  onClick={() => {\r\n                    setPatient(patient._id);\r\n                    setLgShow(false);\r\n                    setPatientSelected(patient.name + \" \" + patient.lastName);\r\n                  }}\r\n                >\r\n                  ID: {patient._id}\r\n                  <br />\r\n                  {patient.name + \" \" + patient.lastName}\r\n                  <br />\r\n                  {patient.email}\r\n                </ListGroup.Item>\r\n              ))\r\n            )}\r\n          </ListGroup>\r\n        </Modal.Body>\r\n      </Modal>\r\n    </>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}